CREATE TABLE IF NOT EXISTS pessoa (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY,
    nome VARCHAR(100) NOT NULL,
    senha VARCHAR(100) NOT NULL,
    email VARCHAR(150) NOT NULL,
    endereco VARCHAR(200) NOT NULL,
    telefone VARCHAR(150) NOT NULL, 
    ativo VARCHAR(7) NOT NULL,
    updated_at DATE,
    created_at DATE,
   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS categoria (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY,
    descricao VARCHAR(100) NOT NULL,
    created_at DATE ,
    updated_at DATE ,
    ativo VARCHAR(7) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS compra (
id INTEGER GENERATED BY DEFAULT AS IDENTITY,
	valorTotal DECIMAL(11,2) NOT NULL,
	parcelas INT NOT NULL,
	id_pessoa INT NOT NULL,
	created_at DATE NOT NULL,
	PRIMARY KEY(id),
	FOREIGN KEY (id_pessoa) REFERENCES pessoa(id)
);

CREATE TABLE IF NOT EXISTS produto (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY,
    descricao VARCHAR(1000) NOT NULL,
    nome VARCHAR(100) NOT NULL,
    valor DECIMAL(11,2) NOT NULL,
    estoque INT NOT NULL,
    id_categoria INT NOT NULL,
    ativo VARCHAR(7) NOT NULL,
    created_at DATE ,
    updated_at DATE ,
    file VARCHAR(40) NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY(id_categoria) REFERENCES categoria(id)
);

CREATE TABLE IF NOT EXISTS itenCarrinho (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY,
    quant INT NOT NULL,
    total DECIMAL(11,2) NOT NULL,
    id_produto INT NOT NULL,
    created_at DATE ,
    PRIMARY KEY (id),
    FOREIGN KEY (id_produto) REFERENCES produto (id)
);


CREATE TABLE IF NOT EXISTS carrinho (
id_compra INT NOT NULL,
	id_iten INT NOT NULL,
	PRIMARY KEY(id_compra, id_iten),
	FOREIGN KEY(id_compra) REFERENCES compra(id),
	FOREIGN KEY(id_iten) REFERENCES itenCarrinho(id)
);
